function resume(){player.body.velocity.x=velocityX,player.body.velocity.y=velocityY,player.body.gravity.y=gravity,playerState=previousState,pauseBlock.kill(),resumeButton.kill(),menuButton.kill(),gameState="GO"}var boot=function(e){};boot.prototype={create:function(){console.log("boot"),this.game.state.start("Preload")}};var startPos=[{startX:100,startY:1150},{startX:100,startY:623},{startX:100,startY:1150},{startX:100,startY:1150},{startX:100,startY:655},{startX:100,startY:1135},{startX:100,startY:1150},{startX:100,startY:1150},{startX:100,startY:1150},{startX:100,startY:623},{startX:100,startY:1150},{startX:100,startY:1150},{startX:100,startY:655},{startX:100,startY:1150},{startX:100,startY:1150}],preload=function(e){};preload.prototype={preload:function(){this.game.load.image("player","assets/player.png"),this.game.load.image("floor","assets/floor.png"),this.game.load.image("upSpring","assets/spring.png"),this.game.load.image("downSpring","assets/spring2.png"),this.game.load.image("flyer","assets/flyer.png"),this.game.load.image("speed","assets/speed.png"),this.game.load.image("slow","assets/slow.png"),this.game.load.tilemap("level1","assets/1.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level2","assets/2.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level3","assets/3.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level4","assets/4.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level5","assets/5.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level6","assets/6.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level7","assets/7.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level8","assets/8.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level9","assets/9.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level10","assets/10.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level11","assets/11.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level12","assets/12.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level13","assets/13.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level14","assets/10.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.tilemap("level15","assets/10.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.image("tileset","assets/tileset.png"),this.game.load.image("title","assets/title.png"),this.game.load.image("play","assets/play.png"),this.game.load.image("1","assets/1.png"),this.game.load.image("2","assets/2.png"),this.game.load.image("3","assets/3.png"),this.game.load.image("4","assets/4.png"),this.game.load.image("5","assets/5.png"),this.game.load.image("6","assets/6.png"),this.game.load.image("7","assets/7.png"),this.game.load.image("8","assets/8.png"),this.game.load.image("9","assets/9.png"),this.game.load.image("10","assets/10.png"),this.game.load.image("11","assets/11.png"),this.game.load.image("12","assets/12.png"),this.game.load.image("13","assets/13.png"),this.game.load.image("14","assets/14.png"),this.game.load.image("15","assets/15.png"),this.game.load.image("pause","assets/pause.png"),this.game.load.image("menu","assets/menu.png"),this.game.load.image("resume","assets/resume.png")},create:function(){console.log("preload"),this.game.state.start("Menu")}};var menu=function(e){};menu.prototype={create:function(){this.game.add.sprite(160,160,"title").anchor.setTo(.5,.5),this.game.add.button(160,320,"play",this.playTheGame,this).anchor.setTo(.5,.5)},playTheGame:function(){console.log("menu"),this.game.state.start("StageSelect")}};var stageSelect=function(e){},stageNumber,maxStageNumber=10;stageSelect.prototype={create:function(){var e=this.game.add.button(60,100,"1",function(){this.playTheGame(1)},this),a=this.game.add.button(145,100,"2",function(){this.playTheGame(2)},this),t=this.game.add.button(230,100,"3",function(){this.playTheGame(3)},this),s=this.game.add.button(315,100,"4",function(){this.playTheGame(4)},this),i=this.game.add.button(400,100,"5",function(){this.playTheGame(5)},this),o=this.game.add.button(485,100,"6",function(){this.playTheGame(6)},this),l=this.game.add.button(570,100,"7",function(){this.playTheGame(7)},this),r=this.game.add.button(655,100,"8",function(){this.playTheGame(8)},this),y=this.game.add.button(740,100,"9",function(){this.playTheGame(9)},this),n=this.game.add.button(825,100,"10",function(){this.playTheGame(10)},this),p=this.game.add.button(60,170,"11",function(){this.playTheGame(11)},this),m=this.game.add.button(145,170,"12",function(){this.playTheGame(12)},this),d=this.game.add.button(230,170,"13",function(){this.playTheGame(13)},this),h=this.game.add.button(315,170,"14",function(){this.playTheGame(10)},this),g=this.game.add.button(400,170,"15",function(){this.playTheGame(10)},this);e.scale.setTo(.75,.75),a.scale.setTo(.75,.75),t.scale.setTo(.75,.75),s.scale.setTo(.75,.75),i.scale.setTo(.75,.75),o.scale.setTo(.75,.75),l.scale.setTo(.75,.75),r.scale.setTo(.75,.75),y.scale.setTo(.75,.75),n.scale.setTo(.75,.75),p.scale.setTo(.75,.75),m.scale.setTo(.75,.75),d.scale.setTo(.75,.75),h.scale.setTo(.75,.75),g.scale.setTo(.75,.75),e.anchor.setTo(.5,.5),a.anchor.setTo(.5,.5),t.anchor.setTo(.5,.5),s.anchor.setTo(.5,.5),i.anchor.setTo(.5,.5),o.anchor.setTo(.5,.5),l.anchor.setTo(.5,.5),r.anchor.setTo(.5,.5),y.anchor.setTo(.5,.5),n.anchor.setTo(.5,.5),p.anchor.setTo(.5,.5),m.anchor.setTo(.5,.5),d.anchor.setTo(.5,.5),h.anchor.setTo(.5,.5),g.anchor.setTo(.5,.5)},playTheGame:function(e){stageNumber=e,this.game.state.start("Game")}};var stageTransition=function(e){};stageTransition.prototype={create:function(){stageNumber<maxStageNumber?stageNumber++:stageNumber=1,this.game.state.start("Game")}};var theGame=function(e){},cursors,gameState="GO",keyup=!1,player,playerState="RUN",startx,starty,blocked=!1,upFacingSprings,downFacingSprings,flyers,speeds,slows,flyerPositionsX=[],flyerPositionsY=[],previousState="RUN",velocityX=0,velocityY=0,gravity=0,startCameraX=0,startCameraY=608,runGravity=200,slowGravity=1500,fastGravity=3e3,map,backgroundLayer,platformCollisionLayer,obstacleCollisionLayer,finishLineLayer,spritelayer,movementSpeed=6,resetSpeed=40,bottomHeight=1200,pauseBlock,resumeButton,menuButton,t;theGame.prototype={create:function(){this.game.renderer.renderSession.roundPixels=!0,gameState="GO",cursors=this.game.input.keyboard.createCursorKeys(),this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.world.enableBody=!0,(map=this.game.add.tilemap("level"+stageNumber,16,16)).addTilesetImage("tileset"),backgroundLayer=map.createLayer("Background"),platformsLayer=map.createLayer("Platforms"),(platformCollisionLayer=map.createLayer("PlatformCollision")).visible=!1,(obstacleCollisionLayer=map.createLayer("ObstacleCollision")).visible=!1,(finishLineLayer=map.createLayer("FinishLine")).visible=!1,(spritelayer=map.createLayer("Sprites")).visible=!1,map.setCollision(17,!0,"PlatformCollision",!0),map.setCollision(17,!0,"ObstacleCollision",!0),map.setCollision(27,!0,"FinishLine",!0),backgroundLayer.resizeWorld(),this.game.physics.enable(map,Phaser.Physics.ARCADE),this.game.physics.enable(platformCollisionLayer,Phaser.Physics.ARCADE),this.game.physics.enable(obstacleCollisionLayer,Phaser.Physics.ARCADE),this.game.physics.enable(finishLineLayer,Phaser.Physics.ARCADE),this.game.camera.x=startCameraX,this.game.camera.y=startCameraY,upFacingSprings=this.game.add.group(),downFacingSprings=this.game.add.group(),flyers=this.game.add.group(),speeds=this.game.add.group(),slows=this.game.add.group();for(var e=0;e<map.height;e++)for(var a=0;a<map.width;a++){var s=map.getTile(a,e,spritelayer);if(null!=s)switch(s.index){case 38:i=this.game.add.sprite(s.worldX,s.worldY+(s.height-11),"upSpring");upFacingSprings.add(i);break;case 39:var i=this.game.add.sprite(s.worldX,s.worldY,"downSpring");downFacingSprings.add(i);break;case 40:var o=this.game.add.sprite(s.worldX,s.worldY+7,"flyer");o.body.setSize(23,15,6,2),flyers.add(o),flyerPositionsX.push(s.worldX),flyerPositionsY.push(s.worldY);break;case 49:var l=this.game.add.sprite(s.worldX,s.worldY,"speed");speeds.add(l);break;case 50:var r=this.game.add.sprite(s.worldX,s.worldY,"slow");slows.add(r)}}if(upFacingSprings.setAll("body.immovable",!0),downFacingSprings.setAll("body.immovable",!0),flyers.setAll("body.immovable",!0),startx=startPos[stageNumber-1].startX,starty=startPos[stageNumber-1].startY,player=this.game.add.sprite(startx,starty,"player"),this.game.physics.enable(player,Phaser.Physics.ARCADE),player.anchor.setTo(.5),player.body.gravity.y=runGravity,playerState="RUN",pauseBlock=this.game.add.sprite(this.game.camera.x+300,this.game.camera.y+100,"pause"),resumeButton=this.game.add.button(this.game.camera.x+325,this.game.camera.y+170,"resume",this.resume,this),menuButton=this.game.add.button(this.game.camera.x+340,this.game.camera.y+250,"menu",this.menu,this),pauseBlock.kill(),resumeButton.kill(),menuButton.kill(),speeds.length>0){var y="Speed: "+Math.floor(10*movementSpeed),n={font:"12px Arial",fill:"#ffffff",align:"center"};t=this.game.add.text(this.game.camera.x+10,this.game.camera.y+10,y,n)}},render:function(){},update:function(){switch(console.log(player.body.velocity.x),speeds.length>0&&(t.position.x=player.body.position.x-60,t.setText("Speed: "+Math.floor(10*movementSpeed))),this.game.physics.arcade.collide(player,platformCollisionLayer),this.game.physics.arcade.collide(player,obstacleCollisionLayer),this.game.physics.arcade.collide(player,finishLineLayer,this.finish,null,this),this.game.physics.arcade.collide(player,upFacingSprings,this.upSpringCollide,null,this),this.game.physics.arcade.overlap(player,downFacingSprings,this.downSpringCollide,null,this),this.game.physics.arcade.overlap(player,speeds,this.speedOverlap,null,this),this.game.physics.arcade.overlap(player,slows,this.slowOverlap,null,this),this.game.physics.arcade.collide(player,flyers,this.flyerCollide,null,this),player.body.velocity.y>800&&(player.body.velocity.y=800),playerState){case"RUN":this.runUpdate();break;case"JUMP":this.jumpUpdate();break;case"SLOWFALL":this.slowfallUpdate();break;case"FASTFALL":this.fastfallUpdate();break;case"RESET":this.resetUpdate()}switch(gameState){case"GO":this.gameGo();break;case"RESET":this.gameReset();break;case"PAUSE":this.gamePause()}},resume:function(){player.body.velocity.x=velocityX,player.body.velocity.y=velocityY,player.body.gravity.y=gravity,playerState=previousState,pauseBlock.kill(),resumeButton.kill(),menuButton.kill(),gameState="GO"},menu:function(){gameState="GO",this.game.state.start("Menu")},stop:function(){player.body.velocity.x=0},flyerEnter:function(e){console.log("WOOP"),e.body.velocity.x=-200},resetUpdate:function(){if(player.body.blocked.down&&this.camera.x<=startCameraX){for(var e=0;e<flyers.length;e++){var a=flyers.getChildAt(e);a.revive(),a.body.position.x=flyerPositionsX[e],a.body.position.y=flyerPositionsY[e],a.body.velocity.x=0}gameState="GO",playerState="RUN"}},finish:function(){flyerPositionsX=[],flyerPositionsY=[],stageNumber<maxStageNumber?stageNumber++:stageNumber=1,gameState="GO",this.game.state.start("Game")},upSpringCollide:function(){switch(playerState){case"FASTFALL":player.body.velocity.y=-900;break;default:player.body.velocity.y=-750}player.body.gravity.y=slowGravity,playerState="JUMP"},downSpringCollide:function(){player.body.gravity.y=4e3,playerState="FASTFALL"},flyerCollide:function(){gameState="RESET",player.body.gravity.y=runGravity,player.body.position.x=startx,player.body.position.y=starty,player.body.velocity.x=0,player.body.velocity.y=0,movementSpeed=6,playerState="RESET"},speedOverlap:function(){movementSpeed+=.1},slowOverlap:function(){movementSpeed-=.1},runUpdate:function(){if(player.body.gravity.y=runGravity,player.body.blocked.right||player.body.position.y>=bottomHeight)return gameState="RESET",player.body.gravity.y=runGravity,player.body.position.x=startx,player.body.position.y=starty,player.body.velocity.x=0,player.body.velocity.y=0,movementSpeed=6,void(playerState="RESET");this.game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)?(player.body.gravity.y=slowGravity,player.body.velocity.y=-600,playerState="JUMP"):player.body.blocked.down||(player.body.gravity.y=runGravity,playerState="SLOWFALL")},jumpUpdate:function(){if(player.body.blocked.right||player.body.position.y>=bottomHeight)return gameState="RESET",player.body.gravity.y=runGravity,player.body.position.x=startx,player.body.position.y=starty,player.body.velocity.x=0,player.body.velocity.y=0,movementSpeed=6,void(playerState="RESET");player.body.velocity.y>=0&&(player.body.gravity.y=runGravity,playerState="SLOWFALL")},slowfallUpdate:function(){if(player.body.blocked.right||player.body.position.y>=bottomHeight)return gameState="RESET",player.body.gravity.y=runGravity,player.body.position.x=startx,player.body.position.y=starty,player.body.velocity.x=0,player.body.velocity.y=0,movementSpeed=6,void(playerState="RESET");this.game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)?(player.body.gravity.y=fastGravity,playerState="FASTFALL"):player.body.blocked.down&&(playerState="RUN")},fastfallUpdate:function(){if(player.body.blocked.right||player.body.position.y>=bottomHeight)return gameState="RESET",player.body.gravity.y=runGravity,player.body.position.x=startx,player.body.position.y=starty,player.body.velocity.x=0,player.body.velocity.y=0,movementSpeed=6,void(playerState="RESET");player.body.blocked.down&&(playerState="RUN")},gameGo:function(){for(e=0;e<flyers.length;e++)(a=flyers.getChildAt(e)).inCamera&&0==a.body.velocity.x&&(a.body.velocity.x=-200);if(player.body.velocity.x=60*movementSpeed,this.game.camera.x=player.body.position.x-100,this.game.input.keyboard.isDown(Phaser.Keyboard.ESC)||(keyup=!0),this.game.input.keyboard.isDown(Phaser.Keyboard.ESC)&&keyup){velocityX=player.body.velocity.x,velocityY=player.body.velocity.y,gravity=player.body.gravity.y,player.body.velocity.x=0,player.body.velocity.y=0,player.body.gravity.y=0,previousState=playerState,playerState="PAUSED";for(var e=0;e<flyers.length;e++){var a=flyers.getChildAt(e);a.body.velocity.x=0}keyup=!1,pauseBlock.position.x=this.game.camera.x+300,pauseBlock.position.y=this.game.camera.y+100,resumeButton.position.x=this.game.camera.x+325,resumeButton.position.y=this.game.camera.y+170,menuButton.position.x=this.game.camera.x+340,menuButton.position.y=this.game.camera.y+250,pauseBlock.revive(),resumeButton.revive(),menuButton.revive(),gameState="PAUSED"}},gameReset:function(){this.game.camera.x-=resetSpeed},gamePause:function(){this.game.input.keyboard.isDown(Phaser.Keyboard.ESC)||(keyup=!0),this.game.input.keyboard.isDown(Phaser.Keyboard.ESC)&&keyup&&(keyup=!1,resume())}};